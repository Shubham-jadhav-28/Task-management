<div class="container mt-5">
  <h4 class="text-success mb-4">Tasks Details</h4>

  <ng-container *ngIf="projectTasks.length > 0; else noTasks">
    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Title</th>
            <th>Assigned To</th>
            <th>Status</th>
            <th>Estimate</th>
            <th>Time Spent</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of projectTasks; let i = index">
            <ng-container *ngIf="editingTaskIndex === i; else displayRow">
              <td>
                <input [(ngModel)]="editedTask.title" class="form-control" />
              </td>
              <td>
                <input
                  [(ngModel)]="editedTask.assignedTo"
                  class="form-control"
                />
              </td>
              <td>
                <select [(ngModel)]="editedTask.status" class="form-select">
                  <option value="High">High</option>
                  <option value="Medium">Medium</option>
                  <option value="Low">Low</option>
                </select>
              </td>
              <td>
                <input
                  type="number"
                  [(ngModel)]="editedTask.estimate"
                  class="form-control"
                />
              </td>
              <td>
                <input
                  type="number"
                  [(ngModel)]="editedTask.timeSpent"
                  class="form-control"
                />
              </td>
              <td class="text-center">
                <div class="d-flex justify-content-center gap-2">
                  <button class="btn btn-primary btn-sm" (click)="saveTask(i)">
                    Save
                  </button>
                  <button
                    class="btn btn-secondary btn-sm"
                    (click)="cancelEdit()"
                  >
                    Cancel
                  </button>
                </div>
              </td>
            </ng-container>

            <ng-template #displayRow>
              <td>{{ task.title }}</td>
              <td>{{ task.assignedTo }}</td>
              <td>{{ task.status }}</td>
              <td>{{ task.estimate }} hrs</td>
              <td>{{ task.timeSpent }} hrs</td>
              <td class="text-center">
                <div class="d-flex justify-content-center gap-2">
                  <button class="btn btn-success btn-sm" (click)="editTask(i)">
                    Edit
                  </button>
                  <button
                    class="btn btn-danger btn-sm"
                    (click)="deleteTask(task)"
                  >
                    Delete
                  </button>
                </div>
              </td>
            </ng-template>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
  <div class="d-flex gap-2 mt-3">
    <button class="btn btn-secondary" (click)="closeProjectDetails()">
      Back to Projects
    </button>
  </div>
  <ng-template #noTasks>
    <div class="alert alert-info text-center">
      No tasks assigned to this project.
    </div>
  </ng-template>
</div>
